From db26e1f82293782edb0a6da852edd4be0ab9897b Mon Sep 17 00:00:00 2001
From: Colin Guthrie <cguthrie@mandriva.org>
Date: Sun, 8 Feb 2009 13:30:48 +0000
Subject: [PATCH] Allow build with -Werror=format-security
 Patch by Adam Williamson

---
 libengine/themer.c  |    6 +++---
 src/engine_loader.c |    2 +-
 themer/main.c       |    2 ++
 3 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/libengine/themer.c b/libengine/themer.c
index c940594..e17bca8 100644
--- a/libengine/themer.c
+++ b/libengine/themer.c
@@ -874,7 +874,7 @@ static void append_engine(gchar * dlname)
     err = dlerror();
     if (!hand || err)
     {
-        g_warning(err);
+        g_warning("%s", err);
         if (hand)
             dlclose(hand);
         return;
@@ -885,7 +885,7 @@ static void append_engine(gchar * dlname)
         layout_settings_proc lay;
         lay = dlsym(hand,"layout_engine_settings");
         if ((err=dlerror()))
-            g_warning(err);
+            g_warning("%s", err);
         if (lay)
         {
             get_meta_info_proc meta;
@@ -896,7 +896,7 @@ static void append_engine(gchar * dlname)
                 "<i><small>%s</small></i>";
             meta = dlsym(hand,"get_meta_info");
             if ((err=dlerror()))
-                g_warning(err);
+                g_warning("%s", err);
                 d->meta.description=g_strdup("No Description");
                 d->meta.version=g_strdup("0.0");
                 d->meta.last_compat=g_strdup("0.0");
diff --git a/src/engine_loader.c b/src/engine_loader.c
index 4b5270f..86aad62 100644
--- a/src/engine_loader.c
+++ b/src/engine_loader.c
@@ -54,7 +54,7 @@ gboolean load_engine(gchar * engine_name, window_settings * ws)
         newengine = dlopen(path,RTLD_NOW);
         if (!newengine)
         {
-            g_warning(dlerror());
+            g_warning("%s", dlerror());
             //here's where we should bail out somehow
         }
     }
diff --git a/themer/main.c b/themer/main.c
index ead154c..2e26e40 100644
--- a/themer/main.c
+++ b/themer/main.c
@@ -264,6 +264,7 @@ static void info_dialog(gchar * val)
             GTK_DIALOG_DESTROY_WITH_PARENT,
             GTK_MESSAGE_INFO,
             GTK_BUTTONS_CLOSE,
+            "%s",
             val);
     gtk_dialog_run(GTK_DIALOG(w));
     gtk_widget_destroy(w);
@@ -275,6 +276,7 @@ static void error_dialog(gchar * val)
             GTK_DIALOG_DESTROY_WITH_PARENT,
             GTK_MESSAGE_ERROR,
             GTK_BUTTONS_CLOSE,
+            "%s",
             val);
     gtk_dialog_run(GTK_DIALOG(w));
     gtk_widget_destroy(w);
-- 
1.6.1.2

